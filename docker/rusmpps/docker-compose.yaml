services:
  rusmpps:
    container_name: rusmpps
    image: jadkhaddad/rusmpps:latest
    environment:
      - RUSMPPS_CONFIG_FILE=/etc/rusmpps/config.yaml
    ports:
      - "2775:2775"
    restart: unless-stopped
    volumes:
      - ./config.yaml:/etc/rusmpps/config.yaml:ro

  # <https://github.com/JadKHaddad/upstream/tree/0.1.0>
  upstream:
    container_name: upstream
    image: jadkhaddad/upstream:0.1.0
    command:
      - "--config-file"
      - "/etc/upstream/config.yaml"
    ports:
      - "2776:2776"
    restart: unless-stopped
    volumes:
      - ./upstream-config.yaml:/etc/upstream/config.yaml:ro
      - /opt/caddy/mnt/data/caddy/certificates/acme-v02.api.letsencrypt.org-directory/rusmpps.rusmpp.org/rusmpps.rusmpp.org.crt:/etc/upstream/cert.pem:ro
      - /opt/caddy/mnt/data/caddy/certificates/acme-v02.api.letsencrypt.org-directory/rusmpps.rusmpp.org/rusmpps.rusmpp.org.key:/etc/upstream/key.pem:ro
